let menu="";let windowWidth=0;function changeURL(id){if(menu!=id){menu=id;let permalink=`../${id}/`;history.pushState({page:id},`reitzner.at - ${id}`,permalink);getContent()}else{mobileNav()}}
function mobileNav(){document.querySelector("nav ul").classList.toggle("mobNavShow");document.querySelector('#overlay').classList.toggle("show")}
function getLocation(){menu=location.pathname.replace(/\//g,'')}
function setActiveMenu(){let active=document.querySelector('.active');if(active)active.classList.toggle('active');document.querySelector(`#${menu}`).parentElement.classList.toggle('active')}
function getContent(){fetch(`/getData.php?con=${menu}`).then(fetchErrors).then(fetchParseJSON).then(fetchUpdatePage).catch(fetchShowErrors);let imgUrl=`/img/header/${menu}.jpg`;fetch(`/getData.php?media=${encodeURIComponent(imgUrl)}`).then(fetchErrors).then(fetchParseJSON).then(fetchUpdateHeaderImg).catch(fetchShowErrors);setActiveMenu();let overlayVisible=document.querySelector("#overlay").classList.contains("show");if(windowWidth<1024&&overlayVisible){mobileNav()}}
function fetchErrors(response){if(!response.ok){throw Error(response.status)}
return response}
function fetchParseJSON(response){return response.json()}
function fetchUpdatePage(json){let title=`reitzner.at - ${menu}`;document.querySelector('section').innerHTML=json.content;document.querySelector('#title').innerHTML=title;document.title=title}
function fetchUpdateHeaderImg(json){let img=document.querySelector("header img");let src=(json.exists==="true")?"/"+json.url:"/img/header/Home.jpg";img.src=src;img.alt=menu}
function fetchShowErrors(err){console.log(err);document.querySelector('main').innerHTML="<h1>Es ist ein unerwarteter Fehler aufgetreten.</h1><br/>"+err}
window.onload=()=>{getLocation();if(menu==""){menu="Home";history.pushState({page:"Home"},"reitzner.at - Home","/Home/")}
setActiveMenu();let menuItems=document.querySelectorAll("nav a");menuItems.forEach((el,ind,obj)=>{if(!el.attributes.target){el.addEventListener("click",(ev)=>{ev.preventDefault()
changeURL(el.id)})}});document.querySelector("#wappen").addEventListener("click",(ev)=>changeURL("wappen"));document.querySelector("#mobileMenu").addEventListener("click",()=>mobileNav());document.querySelector("#overlay").addEventListener("click",()=>mobileNav());window.onpopstate=ev=>{getLocation();let state=ev.originalEvent.state;if(state)getContent();else window.history.back()}
window.onresize=(event)=>{windowWidth=window.innerWidth}}